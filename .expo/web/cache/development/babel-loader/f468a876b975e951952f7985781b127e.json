{"ast":null,"code":"var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _reactNative = require(\"react-native\");\n\nvar _reactNativeWebview = require(\"react-native-webview\");\n\nvar _reactNativeModalbox = _interopRequireDefault(require(\"react-native-modalbox\"));\n\nvar _reactNativeSwipeGestures = _interopRequireDefault(require(\"react-native-swipe-gestures\"));\n\nvar _Story = _interopRequireDefault(require(\"./Story\"));\n\nvar _UserView = _interopRequireDefault(require(\"./UserView\"));\n\nvar _ReadMore = _interopRequireDefault(require(\"./ReadMore\"));\n\nvar _ProgressArray = _interopRequireDefault(require(\"./ProgressArray\"));\n\nvar _this = this,\n    _jsxFileName = \"C:\\\\Program Files\\\\nodejs\\\\ComeClosely\\\\app\\\\views\\\\screens\\\\Messenger\\\\components\\\\StoryContainer.tsx\";\n\nvar SCREEN_WIDTH = _reactNative.Dimensions.get('window').width;\n\nvar StoryContainer = function StoryContainer(props) {\n  var _useState = (0, _react.useState)(0),\n      _useState2 = (0, _slicedToArray2.default)(_useState, 2),\n      currentIndex = _useState2[0],\n      setCurrentIndex = _useState2[1];\n\n  var _useState3 = (0, _react.useState)(false),\n      _useState4 = (0, _slicedToArray2.default)(_useState3, 2),\n      isModelOpen = _useState4[0],\n      setModel = _useState4[1];\n\n  var _useState5 = (0, _react.useState)(false),\n      _useState6 = (0, _slicedToArray2.default)(_useState5, 2),\n      isPause = _useState6[0],\n      setIsPause = _useState6[1];\n\n  var _useState7 = (0, _react.useState)(false),\n      _useState8 = (0, _slicedToArray2.default)(_useState7, 2),\n      isLoaded = _useState8[0],\n      setLoaded = _useState8[1];\n\n  var _useState9 = (0, _react.useState)(3),\n      _useState10 = (0, _slicedToArray2.default)(_useState9, 2),\n      duration = _useState10[0],\n      setDuration = _useState10[1];\n\n  var user = props.user;\n\n  var _ref = user || {},\n      _ref$stories = _ref.stories,\n      stories = _ref$stories === void 0 ? [] : _ref$stories;\n\n  var story = stories.length ? stories[currentIndex] : null;\n\n  var changeStory = function changeStory(evt) {\n    if (evt.locationX > SCREEN_WIDTH / 2) {\n      nextStory();\n    } else {\n      prevStory();\n    }\n  };\n\n  var nextStory = function nextStory() {\n    if (stories.length - 1 > currentIndex) {\n      setCurrentIndex(currentIndex + 1);\n      setLoaded(false);\n      setDuration(3);\n    } else {\n      setCurrentIndex(0);\n      props.onStoryNext();\n    }\n  };\n\n  var prevStory = function prevStory() {\n    if (currentIndex > 0 && stories.length) {\n      setCurrentIndex(currentIndex - 1);\n      setLoaded(false);\n      setDuration(3);\n    } else {\n      setCurrentIndex(0);\n      props.onStoryPrevious();\n    }\n  };\n\n  var onImageLoaded = function onImageLoaded() {\n    setLoaded(true);\n  };\n\n  var onVideoLoaded = function onVideoLoaded(evt) {\n    setLoaded(true);\n    setDuration(evt.duration);\n  };\n\n  var onPause = function onPause(result) {\n    setIsPause(result);\n  };\n\n  var onReadMoreOpen = function onReadMoreOpen() {\n    setIsPause(true);\n    setModel(true);\n  };\n\n  var onReadMoreClose = function onReadMoreClose() {\n    setIsPause(false);\n    setModel(false);\n  };\n\n  var loading = function loading() {\n    if (!isLoaded) {\n      return _react.default.createElement(_reactNative.View, {\n        style: styles.loading,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 9\n        }\n      }, _react.default.createElement(_reactNative.View, {\n        style: {\n          width: 1,\n          height: 1\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 11\n        }\n      }, story && _react.default.createElement(_Story.default, {\n        story: story,\n        pause: true,\n        isNewStory: props.isNewStory,\n        onImageLoaded: onImageLoaded,\n        onVideoLoaded: onVideoLoaded,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 15\n        }\n      })), _react.default.createElement(_reactNative.ActivityIndicator, {\n        color: \"white\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 11\n        }\n      }));\n    }\n  };\n\n  var config = {\n    velocityThreshold: 0.3,\n    directionalOffsetThreshold: 80\n  };\n\n  var onSwipeDown = function onSwipeDown() {\n    if (!isModelOpen) {\n      props.onClose();\n    } else {\n      setModel(false);\n    }\n  };\n\n  var onSwipeUp = function onSwipeUp() {\n    if (!isModelOpen && story.readMoreUrl) {\n      setModel(true);\n    }\n  };\n\n  return _react.default.createElement(_reactNativeSwipeGestures.default, {\n    onSwipeDown: onSwipeDown,\n    onSwipeUp: onSwipeUp,\n    config: config,\n    style: styles.container,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 5\n    }\n  }, _react.default.createElement(_reactNative.TouchableOpacity, {\n    activeOpacity: 1,\n    delayLongPress: 500,\n    onPress: function onPress(e) {\n      return changeStory(e.nativeEvent);\n    },\n    onLongPress: function onLongPress() {\n      return onPause(true);\n    },\n    onPressOut: function onPressOut() {\n      return onPause(false);\n    },\n    style: styles.container,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 7\n    }\n  }, _react.default.createElement(_reactNative.View, {\n    style: styles.container,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 9\n    }\n  }, story && _react.default.createElement(_Story.default, {\n    story: story,\n    pause: isPause,\n    isNewStory: props.isNewStory,\n    onImageLoaded: onImageLoaded,\n    onVideoLoaded: onVideoLoaded,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 13\n    }\n  }), loading(), _react.default.createElement(_UserView.default, {\n    name: user.username,\n    profile: user.profile,\n    time: story.createdAt,\n    onClosePress: props.onClose,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 11\n    }\n  }), console.log('story.readMoreUrl:', story.readMoreUrl), story.readMoreUrl && _react.default.createElement(_ReadMore.default, {\n    onReadMore: onReadMoreOpen,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 33\n    }\n  }), _react.default.createElement(_ProgressArray.default, {\n    next: nextStory,\n    isLoaded: isLoaded,\n    duration: duration,\n    pause: isPause,\n    isNewStory: props.isNewStory,\n    stories: stories,\n    currentIndex: currentIndex,\n    currentStory: stories[currentIndex],\n    length: stories.map(function (_, i) {\n      return i;\n    }),\n    progress: {\n      id: currentIndex\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 11\n    }\n  })), _react.default.createElement(_reactNativeModalbox.default, {\n    style: styles.modal,\n    position: \"bottom\",\n    isOpen: isModelOpen,\n    onClosed: onReadMoreClose,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 9\n    }\n  }, _react.default.createElement(_reactNative.View, {\n    style: styles.bar,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 11\n    }\n  }), _react.default.createElement(_reactNativeWebview.WebView, {\n    source: {\n      uri: story == null ? void 0 : story.readMoreUrl\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 11\n    }\n  }))));\n};\n\nvar styles = _reactNative.StyleSheet.create({\n  container: {\n    flex: 1,\n    width: '100%',\n    justifyContent: 'flex-start',\n    alignItems: 'center',\n    backgroundColor: 'red'\n  },\n  progressBarArray: {\n    flexDirection: 'row',\n    position: 'absolute',\n    top: 30,\n    width: '98%',\n    height: 10,\n    justifyContent: 'space-between',\n    alignItems: 'center'\n  },\n  userView: {\n    flexDirection: 'row',\n    position: 'absolute',\n    top: 55,\n    width: '98%',\n    alignItems: 'center'\n  },\n  name: {\n    fontSize: 18,\n    fontWeight: '500',\n    marginLeft: 12,\n    color: 'white'\n  },\n  time: {\n    fontSize: 12,\n    fontWeight: '400',\n    marginTop: 3,\n    marginLeft: 12,\n    color: 'white'\n  },\n  content: {\n    width: '100%',\n    height: '100%'\n  },\n  loading: {\n    backgroundColor: 'black',\n    height: '100%',\n    width: '100%',\n    alignItems: 'center',\n    justifyContent: 'center'\n  },\n  modal: {\n    width: '100%',\n    height: '90%',\n    backgroundColor: 'white',\n    borderTopLeftRadius: 20,\n    borderTopRightRadius: 20\n  },\n  bar: {\n    width: 50,\n    height: 8,\n    backgroundColor: 'gray',\n    alignSelf: 'center',\n    borderRadius: 4,\n    marginTop: 8\n  }\n});\n\nvar _default = StoryContainer;\nexports.default = _default;","map":{"version":3,"sources":["C:/Program Files/nodejs/ComeClosely/app/views/screens/Messenger/components/StoryContainer.tsx"],"names":["SCREEN_WIDTH","Dimensions","get","width","StoryContainer","props","currentIndex","setCurrentIndex","isModelOpen","setModel","isPause","setIsPause","isLoaded","setLoaded","duration","setDuration","user","stories","story","length","changeStory","evt","locationX","nextStory","prevStory","onStoryNext","onStoryPrevious","onImageLoaded","onVideoLoaded","onPause","result","onReadMoreOpen","onReadMoreClose","loading","styles","height","isNewStory","config","velocityThreshold","directionalOffsetThreshold","onSwipeDown","onClose","onSwipeUp","readMoreUrl","container","e","nativeEvent","username","profile","createdAt","console","log","map","_","i","id","modal","bar","uri","StyleSheet","create","flex","justifyContent","alignItems","backgroundColor","progressBarArray","flexDirection","position","top","userView","name","fontSize","fontWeight","marginLeft","color","time","marginTop","content","borderTopLeftRadius","borderTopRightRadius","alignSelf","borderRadius"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\r\nimport {\r\n  ActivityIndicator,\r\n  Dimensions,\r\n  StyleSheet,\r\n  TouchableOpacity,\r\n  View,\r\n} from 'react-native';\r\n\r\nimport { WebView } from 'react-native-webview';\r\nimport Modal from 'react-native-modalbox';\r\nimport GestureRecognizer from 'react-native-swipe-gestures';\r\n\r\nimport { UserI } from '../types';\r\n\r\nimport Story from './Story';\r\nimport UserView from './UserView';\r\nimport ReadMore from './ReadMore';\r\nimport ProgressArray from './ProgressArray';\r\n\r\nconst SCREEN_WIDTH = Dimensions.get('window').width;\r\n\r\ninterface ComponentProp {\r\n  user: UserI;\r\n  isNewStory: boolean;\r\n  onStoryNext: any;\r\n  onStoryPrevious: any;\r\n  onClose: any;\r\n}\r\n\r\nconst StoryContainer = (props: ComponentProp) => {\r\n  const [currentIndex, setCurrentIndex] = useState(0);\r\n  const [isModelOpen, setModel] = useState(false);\r\n  const [isPause, setIsPause] = useState(false);\r\n  const [isLoaded, setLoaded] = useState(false);\r\n  const [duration, setDuration] = useState(3);\r\n\r\n  const { user } = props;\r\n  const { stories = [] } = user || {};\r\n  const story = stories.length ? stories[currentIndex] : null;\r\n\r\n  const changeStory = (evt: any) => {\r\n    if (evt.locationX > SCREEN_WIDTH / 2) {\r\n      nextStory();\r\n    } else {\r\n      prevStory();\r\n    }\r\n  };\r\n\r\n  const nextStory = () => {\r\n    if (stories.length - 1 > currentIndex) {\r\n      setCurrentIndex(currentIndex + 1);\r\n      setLoaded(false);\r\n      setDuration(3);\r\n    } else {\r\n      setCurrentIndex(0);\r\n      props.onStoryNext();\r\n    }\r\n  };\r\n\r\n  const prevStory = () => {\r\n    if (currentIndex > 0 && stories.length) {\r\n      setCurrentIndex(currentIndex - 1);\r\n      setLoaded(false);\r\n      setDuration(3);\r\n    } else {\r\n      setCurrentIndex(0);\r\n      props.onStoryPrevious();\r\n    }\r\n  };\r\n\r\n  const onImageLoaded = () => {\r\n    setLoaded(true);\r\n  };\r\n\r\n  const onVideoLoaded = (evt: any) => {\r\n    setLoaded(true);\r\n    setDuration(evt.duration);\r\n  };\r\n\r\n  const onPause = (result: boolean) => {\r\n    setIsPause(result);\r\n  };\r\n\r\n  const onReadMoreOpen = () => {\r\n    setIsPause(true);\r\n    setModel(true);\r\n  };\r\n  const onReadMoreClose = () => {\r\n    setIsPause(false);\r\n    setModel(false);\r\n  };\r\n\r\n  const loading = () => {\r\n    if (!isLoaded) {\r\n      return (\r\n        <View style={styles.loading}>\r\n          <View style={{ width: 1, height: 1 }}>\r\n            {story && (\r\n              <Story\r\n                story={story}\r\n                pause\r\n                isNewStory={props.isNewStory}\r\n                onImageLoaded={onImageLoaded}\r\n                onVideoLoaded={onVideoLoaded}\r\n              />\r\n            )}\r\n          </View>\r\n          <ActivityIndicator color=\"white\" />\r\n        </View>\r\n      );\r\n    }\r\n  };\r\n\r\n  const config = {\r\n    velocityThreshold: 0.3,\r\n    directionalOffsetThreshold: 80,\r\n  };\r\n\r\n  const onSwipeDown = () => {\r\n    if (!isModelOpen) {\r\n      props.onClose();\r\n    } else {\r\n      setModel(false);\r\n    }\r\n  };\r\n\r\n  const onSwipeUp = () => {\r\n    if (!isModelOpen && story.readMoreUrl) {\r\n      setModel(true);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <GestureRecognizer\r\n      onSwipeDown={onSwipeDown}\r\n      onSwipeUp={onSwipeUp}\r\n      config={config}\r\n      style={styles.container}>\r\n      <TouchableOpacity\r\n        activeOpacity={1}\r\n        delayLongPress={500}\r\n        onPress={(e) => changeStory(e.nativeEvent)}\r\n        onLongPress={() => onPause(true)}\r\n        onPressOut={() => onPause(false)}\r\n        style={styles.container}>\r\n        <View style={styles.container}>\r\n          {story && (\r\n            <Story\r\n              story={story}\r\n              pause={isPause}\r\n              isNewStory={props.isNewStory}\r\n              onImageLoaded={onImageLoaded}\r\n              onVideoLoaded={onVideoLoaded}\r\n            />\r\n          )}\r\n\r\n          {loading()}\r\n          <UserView\r\n            name={user.username}\r\n            profile={user.profile}\r\n            time={story.createdAt}\r\n            onClosePress={props.onClose}\r\n          />\r\n          {console.log('story.readMoreUrl:', story.readMoreUrl)}\r\n          {story.readMoreUrl && <ReadMore onReadMore={onReadMoreOpen} />}\r\n\r\n          <ProgressArray\r\n            next={nextStory}\r\n            isLoaded={isLoaded}\r\n            duration={duration}\r\n            pause={isPause}\r\n            isNewStory={props.isNewStory}\r\n            stories={stories}\r\n            currentIndex={currentIndex}\r\n            currentStory={stories[currentIndex]}\r\n            length={stories.map((_, i) => i)}\r\n            progress={{ id: currentIndex }}\r\n          />\r\n        </View>\r\n\r\n        <Modal\r\n          style={styles.modal}\r\n          position=\"bottom\"\r\n          isOpen={isModelOpen}\r\n          onClosed={onReadMoreClose}>\r\n          <View style={styles.bar} />\r\n          <WebView source={{ uri: story?.readMoreUrl }} />\r\n        </Modal>\r\n      </TouchableOpacity>\r\n    </GestureRecognizer>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    width: '100%',\r\n    justifyContent: 'flex-start',\r\n    alignItems: 'center',\r\n    backgroundColor: 'red',\r\n  },\r\n  progressBarArray: {\r\n    flexDirection: 'row',\r\n    position: 'absolute',\r\n    top: 30,\r\n    width: '98%',\r\n    height: 10,\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n  },\r\n  userView: {\r\n    flexDirection: 'row',\r\n    position: 'absolute',\r\n    top: 55,\r\n    width: '98%',\r\n    alignItems: 'center',\r\n  },\r\n  name: {\r\n    fontSize: 18,\r\n    fontWeight: '500',\r\n    marginLeft: 12,\r\n    color: 'white',\r\n  },\r\n  time: {\r\n    fontSize: 12,\r\n    fontWeight: '400',\r\n    marginTop: 3,\r\n    marginLeft: 12,\r\n    color: 'white',\r\n  },\r\n  content: { width: '100%', height: '100%' },\r\n  loading: {\r\n    backgroundColor: 'black',\r\n    height: '100%',\r\n    width: '100%',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n  },\r\n  modal: {\r\n    width: '100%',\r\n    height: '90%',\r\n    backgroundColor: 'white',\r\n    borderTopLeftRadius: 20,\r\n    borderTopRightRadius: 20,\r\n  },\r\n  bar: {\r\n    width: 50,\r\n    height: 8,\r\n    backgroundColor: 'gray',\r\n    alignSelf: 'center',\r\n    borderRadius: 4,\r\n    marginTop: 8,\r\n  },\r\n});\r\n\r\nexport default StoryContainer;\r\n"]},"metadata":{},"sourceType":"script"}