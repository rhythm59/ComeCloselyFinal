{"ast":null,"code":"var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.handleStorageEvent = handleStorageEvent;\nexports.getHttpUrlParts = getHttpUrlParts;\nexports.getGsUrlParts = getGsUrlParts;\nexports.validateMetadata = validateMetadata;\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _common = require(\"@react-native-firebase/app/lib/common\");\n\nvar _internal = require(\"@react-native-firebase/app/lib/internal\");\n\nvar SETTABLE_FIELDS = ['cacheControl', 'contentDisposition', 'contentEncoding', 'contentLanguage', 'contentType', 'customMetadata'];\n\nfunction handleStorageEvent(storageInstance, event) {\n  var taskId = event.taskId,\n      eventName = event.eventName;\n  var body = event.body || {};\n\n  if (body.error) {\n    body.error = _internal.NativeFirebaseError.fromEvent(body.error, storageInstance._config.namespace);\n  }\n\n  storageInstance.emitter.emit(storageInstance.eventNameForApp(taskId, eventName), body);\n}\n\nfunction getHttpUrlParts(url) {\n  var decoded = decodeURIComponent(url);\n  var parts = decoded.match(/\\/b\\/(.*)\\.appspot.com\\/o\\/([a-zA-Z0-9./\\-_]+)(.*)/);\n\n  if (!parts || parts.length < 3) {\n    return null;\n  }\n\n  return {\n    bucket: \"gs://\" + parts[1],\n    path: parts[2]\n  };\n}\n\nfunction getGsUrlParts(url) {\n  var bucket = url.substring(0, url.indexOf('/', 5)) || url;\n  var path = (url.indexOf('/', 5) > -1 ? url.substring(url.indexOf('/', 5) + 1, url.length) : '/') || '/';\n  return {\n    bucket: bucket,\n    path: path\n  };\n}\n\nfunction validateMetadata(metadata) {\n  if (!(0, _common.isObject)(metadata)) {\n    throw new Error('firebase.storage.SettableMetadata must be an object value if provided.');\n  }\n\n  var metadataEntries = Object.entries(metadata);\n\n  for (var i = 0; i < metadataEntries.length; i++) {\n    var _metadataEntries$i = (0, _slicedToArray2.default)(metadataEntries[i], 2),\n        key = _metadataEntries$i[0],\n        value = _metadataEntries$i[1];\n\n    if (!SETTABLE_FIELDS.includes(key)) {\n      throw new Error(\"firebase.storage.SettableMetadata unknown property '\" + key + \"' provided for metadata.\");\n    }\n\n    if (key !== 'customMetadata') {\n      if (!(0, _common.isString)(value) && !(0, _common.isNull)(value)) {\n        throw new Error(\"firebase.storage.SettableMetadata invalid property '\" + key + \"' should be a string or null value.\");\n      }\n    } else if (!(0, _common.isObject)(value)) {\n      throw new Error('firebase.storage.SettableMetadata.customMetadata must be an object of keys and string values.');\n    }\n  }\n\n  return metadata;\n}","map":{"version":3,"sources":["C:/Program Files/nodejs/ComeClosely/node_modules/@react-native-firebase/storage/lib/utils.js"],"names":["SETTABLE_FIELDS","handleStorageEvent","storageInstance","event","taskId","eventName","body","error","NativeFirebaseError","fromEvent","_config","namespace","emitter","emit","eventNameForApp","getHttpUrlParts","url","decoded","decodeURIComponent","parts","match","length","bucket","path","getGsUrlParts","substring","indexOf","validateMetadata","metadata","Error","metadataEntries","Object","entries","i","key","value","includes"],"mappings":"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","sourcesContent":["/*\n * Copyright (c) 2016-present Invertase Limited & Contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this library except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n */\n\nimport { isNull, isObject, isString } from '@react-native-firebase/app/lib/common';\nimport { NativeFirebaseError } from '@react-native-firebase/app/lib/internal';\n\nconst SETTABLE_FIELDS = [\n  'cacheControl',\n  'contentDisposition',\n  'contentEncoding',\n  'contentLanguage',\n  'contentType',\n  'customMetadata',\n];\n\nexport function handleStorageEvent(storageInstance, event) {\n  const { taskId, eventName } = event;\n  const body = event.body || {};\n\n  if (body.error) {\n    body.error = NativeFirebaseError.fromEvent(body.error, storageInstance._config.namespace);\n  }\n\n  storageInstance.emitter.emit(storageInstance.eventNameForApp(taskId, eventName), body);\n}\n\nexport function getHttpUrlParts(url) {\n  const decoded = decodeURIComponent(url);\n  const parts = decoded.match(/\\/b\\/(.*)\\.appspot.com\\/o\\/([a-zA-Z0-9./\\-_]+)(.*)/);\n\n  if (!parts || parts.length < 3) {\n    return null;\n  }\n\n  return { bucket: `gs://${parts[1]}`, path: parts[2] };\n}\n\nexport function getGsUrlParts(url) {\n  const bucket = url.substring(0, url.indexOf('/', 5)) || url;\n  const path =\n    (url.indexOf('/', 5) > -1 ? url.substring(url.indexOf('/', 5) + 1, url.length) : '/') || '/';\n\n  return { bucket, path };\n}\n\nexport function validateMetadata(metadata) {\n  if (!isObject(metadata)) {\n    throw new Error('firebase.storage.SettableMetadata must be an object value if provided.');\n  }\n\n  const metadataEntries = Object.entries(metadata);\n\n  for (let i = 0; i < metadataEntries.length; i++) {\n    const [key, value] = metadataEntries[i];\n    // validate keys\n    if (!SETTABLE_FIELDS.includes(key)) {\n      throw new Error(\n        `firebase.storage.SettableMetadata unknown property '${key}' provided for metadata.`,\n      );\n    }\n\n    // validate values\n    if (key !== 'customMetadata') {\n      if (!isString(value) && !isNull(value)) {\n        throw new Error(\n          `firebase.storage.SettableMetadata invalid property '${key}' should be a string or null value.`,\n        );\n      }\n    } else if (!isObject(value)) {\n      throw new Error(\n        'firebase.storage.SettableMetadata.customMetadata must be an object of keys and string values.',\n      );\n    }\n  }\n\n  return metadata;\n}\n"]},"metadata":{},"sourceType":"script"}